(self.webpackChunkinstant_hie_docs=self.webpackChunkinstant_hie_docs||[]).push([[938],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3919:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,{b:function(){return a},Z:function(){return r}})},4996:function(e,t,n){"use strict";n.d(t,{C:function(){return i},Z:function(){return o}});var a=n(2263),r=n(3919);function i(){var e=(0,a.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var i=void 0===a?{}:a,o=i.forcePrependBaseUrl,l=void 0!==o&&o,s=i.absolute,c=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,r.b)(n))return n;if(l)return t+n;var u=n.startsWith(t)?n:t+n.replace(/^\//,"");return c?e+u:u}(i,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},8215:function(e,t,n){"use strict";var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:r},t)}},1395:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(7294),r=n(944),i=n(6010),o="tabItem_1uMI",l="tabItemActive_2DSg";var s=37,c=39;var u=function(e){var t=e.lazy,n=e.block,u=e.defaultValue,p=e.values,d=e.groupId,m=e.className,h=(0,r.Z)(),k=h.tabGroupChoices,f=h.setTabGroupChoices,g=(0,a.useState)(u),y=g[0],v=g[1],b=a.Children.toArray(e.children),w=[];if(null!=d){var N=k[d];null!=N&&N!==y&&p.some((function(e){return e.value===N}))&&v(N)}var C=function(e){var t=e.currentTarget,n=w.indexOf(t),a=p[n].value;v(a),null!=d&&(f(d,a),setTimeout((function(){var e,n,a,r,i,o,s,c;(e=t.getBoundingClientRect(),n=e.top,a=e.left,r=e.bottom,i=e.right,o=window,s=o.innerHeight,c=o.innerWidth,n>=0&&i<=c&&r<=s&&a>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l),setTimeout((function(){return t.classList.remove(l)}),2e3))}),150))},O=function(e){var t,n;switch(e.keyCode){case c:var a=w.indexOf(e.target)+1;n=w[a]||w[0];break;case s:var r=w.indexOf(e.target)-1;n=w[r]||w[w.length-1]}null==(t=n)||t.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},m)},p.map((function(e){var t=e.value,n=e.label;return a.createElement("li",{role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,className:(0,i.Z)("tabs__item",o,{"tabs__item--active":y===t}),key:t,ref:function(e){return w.push(e)},onKeyDown:O,onFocus:C,onClick:C},n)}))),t?(0,a.cloneElement)(b.filter((function(e){return e.props.value===y}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},b.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==y})}))))}},9443:function(e,t,n){"use strict";var a=(0,n(7294).createContext)(void 0);t.Z=a},944:function(e,t,n){"use strict";var a=n(7294),r=n(9443);t.Z=function(){var e=(0,a.useContext)(r.Z);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},5433:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),o=n(1395),l=n(8215),s=(n(4996),{id:"client",title:"Client-Registry",sidebar_label:"Client-Registry",keywords:["Instant OpenHIE","Client","Registry","Package"],description:"The client registry package of the Instant OpenHIE"}),c={unversionedId:"packages/client",id:"packages/client",isDocsHomePage:!1,title:"Client-Registry",description:"The client registry package of the Instant OpenHIE",source:"@site/docs/packages/client.mdx",sourceDirName:"packages",slug:"/packages/client",permalink:"/instant/docs/packages/client",editUrl:"https://github.com/openhie/instant/tree/master/docs/docs/packages/client.mdx",version:"current",sidebar_label:"Client-Registry",frontMatter:{id:"client",title:"Client-Registry",sidebar_label:"Client-Registry",keywords:["Instant OpenHIE","Client","Registry","Package"],description:"The client registry package of the Instant OpenHIE"}},u=[{value:"Package functionality",id:"package-functionality",children:[]},{value:"Deployment strategy",id:"deployment-strategy",children:[]},{value:"Client Registry Package Dev guide",id:"client-registry-package-dev-guide",children:[]},{value:"OpenCR config",id:"opencr-config",children:[]}],p={toc:u};function d(e){var t=e.components,n=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The Instant OpenHIE architecture, codebase, and documentation are under active development and are subject to change. While we encourage adoption and extension of the Instant OpenHIE framework, we do not consider this ready for production use at this stage."))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This package is still under development"))),(0,i.kt)("p",null,"The Client Registry Package is a key component of Instant OpenHIE.\nOur reference technology is the ",(0,i.kt)("a",{parentName:"p",href:"https://www.openclientregistry.org"},"Open Client Registry (OpenCR)")," service which has two dependencies:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://hapifhir.io/"},"HAPI FHIR")," (this is the Core package FHIR Server instance)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/"},"Elastic Search"))),(0,i.kt)("h2",{id:"package-functionality"},"Package functionality"),(0,i.kt)("p",null,"OpenCR provides a unique identifier for patients (clients) that links to all other already matched records from all submitting systems.\nPlease see the ",(0,i.kt)("a",{parentName:"p",href:"https://intrahealth.github.io/client-registry/user/introduction/"},"documentation")," for more about client registries and OpenCR."),(0,i.kt)("h2",{id:"deployment-strategy"},"Deployment strategy"),(0,i.kt)("p",null,"OpenCR was already dockerised so we were able to re-use those images for our work in the client package."),(0,i.kt)("p",null,"We supplied a Docker Compose file for the setup and configuration of this application."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Main")," ",(0,i.kt)("inlineCode",{parentName:"li"},"docker-compose.yml")," file - sets up the base applications")),(0,i.kt)("p",null,"For Kubernetes, we created deployment and service resource files for each component of each application.\nThe setup is orchestrated by a ",(0,i.kt)("inlineCode",{parentName:"p"},"kustomization.yml")," file for easy deployment."),(0,i.kt)("h2",{id:"client-registry-package-dev-guide"},"Client Registry Package Dev guide"),(0,i.kt)("p",null,"For testing purposes, this package can be run independently. Below are some notes of how to do this.\nThe recommended way to run Instant OpenHIE is described ",(0,i.kt)("a",{parentName:"p",href:"/instant/docs/introduction/getting-started"},"here"),"."),(0,i.kt)("p",null,"Select a deployment target below and follow the getting started steps in setting up this package."),(0,i.kt)(o.Z,{defaultValue:"dockerCompose",values:[{label:"Docker Compose",value:"dockerCompose"},{label:"Kubernetes",value:"kubernetes"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"dockerCompose",mdxType:"TabItem"},(0,i.kt)("p",null,"Before proceeding, ensure that you are in the root Instant OpenHIE directory."),(0,i.kt)("p",null,"From the working directory, execute the follow:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant init -t docker client\n")),(0,i.kt)("p",null,"This command will start up the ",(0,i.kt)("inlineCode",{parentName:"p"},"core")," package depedency first. Then it will create all the Client pacakge services and print out their logs in the terminal."),(0,i.kt)("h4",{id:"view-running-docker-resources"},"View running Docker resources"),(0,i.kt)("p",null,"Execute the below commands to see the running Docker containers and the state that they are in."),(0,i.kt)("p",null,"To display all containers:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"docker ps -a\n")),(0,i.kt)("p",null,"To stop the containers, use the command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant down -t docker client\n")),(0,i.kt)("p",null,"To completely remove all project components, use the following option:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant destroy -t docker client\n"))),(0,i.kt)(l.Z,{value:"kubernetes",mdxType:"TabItem"},(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"If you are working with multiple cluster hosting clients you may need to switch cluster context for your deployment. See the below commands:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl config get-contexts\nkubectl config use-context <context-name>\n")),(0,i.kt)("h4",{id:"minikube-local"},"Minikube (local)"),(0,i.kt)("p",null,"For the Kubernetes deployment to work as expected, we need to ensure we have ",(0,i.kt)("inlineCode",{parentName:"p"},"minikube")," installed on our local machine running the deployment.\nFollow these steps to ",(0,i.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/tools/install-minikube/"},"install minikube")),(0,i.kt)("p",null,"Once installed, we can start the minikube service by executing the below command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"minikube start --cpus 4 --memory 8192\n")),(0,i.kt)("p",null,"This also updates the VM settings to make use of 4 CPU's and 8GB of RAM, instead of the default 2 CPU's and 4GB of RAM"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Add more CPUs and Memory if you have spare capacity, especially if you plan on adding more packages later.")),(0,i.kt)("h4",{id:"getting-started"},"Getting Started"),(0,i.kt)("p",null,"Useful Links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/cheatsheets/getting-started-with-kubernetes-a-kubectl-cheat-sheet"},"Kubectl Cheat Sheet"))),(0,i.kt)("p",null,"Before proceeding, ensure that you are in the root Instant OpenHIE directory.\nFrom the working directory, execute the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant init -t k8s client\n")),(0,i.kt)("p",null,"The OpenCR console url will be displayed in the terminal output when the script completes. The Url may take a few minutes to become active as the pod may not be fully initialized yet."),(0,i.kt)("p",null,"This bash script will apply the kubernetes ",(0,i.kt)("inlineCode",{parentName:"p"},"kustomization.yaml")," file which controls the ",(0,i.kt)("inlineCode",{parentName:"p"},"Client Package")," component (i.e. OpenCR)."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"On first run, the setup may take up to 10 minutes as the Docker images for each component will need to be pulled. This won't happen on future runs.")),(0,i.kt)("h4",{id:"view-running-kubernetes-resources"},"View running Kubernetes resources"),(0,i.kt)("p",null,"Execute the below commands to see the running Kubernetes resources and the state that they are in."),(0,i.kt)("p",null,"To display all resource: (Some new resources are not listed here)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl get all --all-namespaces\n")),(0,i.kt)("p",null,"To tear down this deployment, use the opposing command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant down -t k8s client\n")),(0,i.kt)("p",null,"To completely remove all project components, use the following option:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn docker:instant destroy -t k8s client\n")),(0,i.kt)("hr",null))),(0,i.kt)("h2",{id:"opencr-config"},"OpenCR config"),(0,i.kt)("p",null,"Configuring OpenCR can be done via a config file or environment variables.\nIn the Instant OpenHIE context, a config file seems to be the easiest method.\nThis involves adding a new config file into the ",(0,i.kt)("em",{parentName:"p"},"OpenCR config directory of the container's volume"),".\nThen restart the OpenCR instance for the new config to take effect."))}d.isMDXComponent=!0},6010:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function r(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}n.d(t,{Z:function(){return r}})}}]);