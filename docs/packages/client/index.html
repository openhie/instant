<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/instant/blog/rss.xml" title="Instant OpenHIE Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/instant/blog/atom.xml" title="Instant OpenHIE Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Instant OpenHIE" href="/instant/opensearch.xml"><title data-react-helmet="true">Client-Registry | Instant OpenHIE</title><meta data-react-helmet="true" property="og:url" content="https://openhie.github.io/instant/docs/packages/client"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Client-Registry | Instant OpenHIE"><meta data-react-helmet="true" name="description" content="The client registry package of the Instant OpenHIE"><meta data-react-helmet="true" property="og:description" content="The client registry package of the Instant OpenHIE"><meta data-react-helmet="true" name="keywords" content="Instant OpenHIE,Client,Registry,Package"><link data-react-helmet="true" rel="shortcut icon" href="/instant/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openhie.github.io/instant/docs/packages/client"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/packages/client" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/packages/client" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/instant/assets/css/styles.418955fb.css">
<link rel="preload" href="/instant/assets/js/runtime~main.017a3597.js" as="script">
<link rel="preload" href="/instant/assets/js/main.bc5f98cf.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a><a class="navbar__item navbar__link" href="/instant/docs/introduction/vision">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/instant/docs/introduction/vision">Docs</a></li><li class="menu__list-item"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Client-Registry</h1></header><div class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The Instant OpenHIE architecture, codebase, and documentation are under active development and are subject to change. While we encourage adoption and extension of the Instant OpenHIE framework, we do not consider this ready for production use at this stage.</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This package is still under development</p></div></div><p>The Client Registry Package is a key component of Instant OpenHIE.
Our reference technology is the <a href="https://www.openclientregistry.org" target="_blank" rel="noopener noreferrer">Open Client Registry (OpenCR)</a> service which has two dependencies:</p><ul><li><a href="https://hapifhir.io/" target="_blank" rel="noopener noreferrer">HAPI FHIR</a> (this is the Core package FHIR Server instance)</li><li><a href="https://www.elastic.co/" target="_blank" rel="noopener noreferrer">Elastic Search</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="package-functionality"></a>Package functionality<a class="hash-link" href="#package-functionality" title="Direct link to heading">#</a></h2><p>OpenCR provides a unique identifier for patients (clients) that links to all other already matched records from all submitting systems.
Please see the <a href="https://intrahealth.github.io/client-registry/user/introduction/" target="_blank" rel="noopener noreferrer">documentation</a> for more about client registries and OpenCR.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deployment-strategy"></a>Deployment strategy<a class="hash-link" href="#deployment-strategy" title="Direct link to heading">#</a></h2><p>OpenCR was already dockerised so we were able to re-use those images for our work in the client package.</p><p>We supplied a Docker Compose file for the setup and configuration of this application.</p><ol><li><strong>Main</strong> <code>docker-compose.yml</code> file - sets up the base applications</li></ol><p>For Kubernetes, we created deployment and service resource files for each component of each application.
The setup is orchestrated by a <code>kustomization.yml</code> file for easy deployment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="client-registry-package-dev-guide"></a>Client Registry Package Dev guide<a class="hash-link" href="#client-registry-package-dev-guide" title="Direct link to heading">#</a></h2><p>For testing purposes, this package can be run independently. Below are some notes of how to do this.
The recommended way to run Instant OpenHIE is described <a href="/instant/docs/introduction/getting-started">here</a>.</p><p>Select a deployment target below and follow the getting started steps in setting up this package.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Docker Compose</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Kubernetes</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>Before proceeding, ensure that you are in the root Instant OpenHIE directory.</p><p>From the working directory, execute the follow:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant init -t docker client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This command will start up the <code>core</code> package depedency first. Then it will create all the Client pacakge services and print out their logs in the terminal.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="view-running-docker-resources"></a>View running Docker resources<a class="hash-link" href="#view-running-docker-resources" title="Direct link to heading">#</a></h4><p>Execute the below commands to see the running Docker containers and the state that they are in.</p><p>To display all containers:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker ps -a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To stop the containers, use the command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant down -t docker client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To completely remove all project components, use the following option:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant destroy -t docker client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><blockquote><p>If you are working with multiple cluster hosting clients you may need to switch cluster context for your deployment. See the below commands:</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl config get-contexts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl config use-context &lt;context-name&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="minikube-local"></a>Minikube (local)<a class="hash-link" href="#minikube-local" title="Direct link to heading">#</a></h4><p>For the Kubernetes deployment to work as expected, we need to ensure we have <code>minikube</code> installed on our local machine running the deployment.
Follow these steps to <a href="https://kubernetes.io/docs/tasks/tools/install-minikube/" target="_blank" rel="noopener noreferrer">install minikube</a></p><p>Once installed, we can start the minikube service by executing the below command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">minikube start --cpus 4 --memory 8192</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This also updates the VM settings to make use of 4 CPU&#x27;s and 8GB of RAM, instead of the default 2 CPU&#x27;s and 4GB of RAM</p><blockquote><p>Add more CPUs and Memory if you have spare capacity, especially if you plan on adding more packages later.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-started"></a>Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">#</a></h4><p>Useful Links:</p><ul><li><a href="https://www.digitalocean.com/community/cheatsheets/getting-started-with-kubernetes-a-kubectl-cheat-sheet" target="_blank" rel="noopener noreferrer">Kubectl Cheat Sheet</a></li></ul><p>Before proceeding, ensure that you are in the root Instant OpenHIE directory.
From the working directory, execute the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant init -t k8s client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The OpenCR console url will be displayed in the terminal output when the script completes. The Url may take a few minutes to become active as the pod may not be fully initialized yet.</p><p>This bash script will apply the kubernetes <code>kustomization.yaml</code> file which controls the <code>Client Package</code> component (i.e. OpenCR).</p><blockquote><p>On first run, the setup may take up to 10 minutes as the Docker images for each component will need to be pulled. This won&#x27;t happen on future runs.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="view-running-kubernetes-resources"></a>View running Kubernetes resources<a class="hash-link" href="#view-running-kubernetes-resources" title="Direct link to heading">#</a></h4><p>Execute the below commands to see the running Kubernetes resources and the state that they are in.</p><p>To display all resource: (Some new resources are not listed here)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get all --all-namespaces</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To tear down this deployment, use the opposing command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant down -t k8s client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To completely remove all project components, use the following option:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> docker:instant destroy -t k8s client</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><hr></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="opencr-config"></a>OpenCR config<a class="hash-link" href="#opencr-config" title="Direct link to heading">#</a></h2><p>Configuring OpenCR can be done via a config file or environment variables.
In the Instant OpenHIE context, a config file seems to be the easiest method.
This involves adding a new config file into the <em>OpenCR config directory of the container&#x27;s volume</em>.
Then restart the OpenCR instance for the new config to take effect.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/openhie/instant/tree/master/docs/docs/packages/client.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#package-functionality" class="table-of-contents__link">Package functionality</a></li><li><a href="#deployment-strategy" class="table-of-contents__link">Deployment strategy</a></li><li><a href="#client-registry-package-dev-guide" class="table-of-contents__link">Client Registry Package Dev guide</a></li><li><a href="#opencr-config" class="table-of-contents__link">OpenCR config</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://ohie.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenHIE</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div></div></div></footer></div>
<script src="/instant/assets/js/runtime~main.017a3597.js"></script>
<script src="/instant/assets/js/main.bc5f98cf.js"></script>
</body>
</html>