<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/instant/blog/rss.xml" title="Instant OpenHIE Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/instant/blog/atom.xml" title="Instant OpenHIE Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Instant OpenHIE" href="/instant/opensearch.xml"><title data-react-helmet="true">Core Package | Instant OpenHIE</title><meta data-react-helmet="true" property="og:url" content="https://openhie.github.io/instant/docs/packages/core"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Core Package | Instant OpenHIE"><meta data-react-helmet="true" name="description" content="The core package of the Instant OpenHIE"><meta data-react-helmet="true" property="og:description" content="The core package of the Instant OpenHIE"><meta data-react-helmet="true" name="keywords" content="Instant OpenHIE,Core,Package"><link data-react-helmet="true" rel="shortcut icon" href="/instant/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openhie.github.io/instant/docs/packages/core"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/packages/core" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/packages/core" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/instant/assets/css/styles.65446951.css">
<link rel="preload" href="/instant/assets/js/runtime~main.2e65fd97.js" as="script">
<link rel="preload" href="/instant/assets/js/main.a4fada6b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a><a class="navbar__item navbar__link" href="/instant/docs/introduction/vision">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/instant/docs/introduction/vision">Docs</a></li><li class="menu__list-item"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/vision">Vision</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/community">Community</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/package-arch">Packages</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How-to</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/creating-packages">Create packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/setup-kubernetes-in-cloud">Setup managed Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/configure-openhim-mapping-mediator">Configure OpenHIM Mapping Mediator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/configure-dhis2">Configure HMIS (DHIS2)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/setup-instant-on-windows-wsl">Setup instant on Windows</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Existing Packages</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/instant/docs/packages/core">Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/facility">Facility-Registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/hmis">Health Management Information System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/health-worker">Health-Worker-Registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/health-workforce">Health-Workforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/client">Client-Registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/elastic">Elastic analytics</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">More Information</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/more-info/architecture">Architecture</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Core Package</h1></header><div class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The Instant OpenHIE architecture, codebase, and documentation are under active development and are subject to change. While we encourage adoption and extension of the Instant OpenHIE framework, we do not consider this ready for production use at this stage.</p></div></div><p>The Instant OpenHIE Core Package is the common base of the Instant OpenHIE system and it provides fundamental components that other packages may build off of.</p><p>This package consists of two components that support all other packages, these are:</p><ul><li>An Interoperability Layer - <a href="http://openhim.org/" target="_blank" rel="noopener noreferrer">OpenHIM</a></li><li>A FHIR Server - <a href="https://hapifhir.io/" target="_blank" rel="noopener noreferrer">HAPI FHIR</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="package-functionality"></a>Package functionality<a class="hash-link" href="#package-functionality" title="Direct link to heading">#</a></h2><p>This package sets up containers that support the OpenHIM as well as the HAPI FHIR server.
It also configures the OpenHIM with a <em>HAPI FHIR channel</em>. This allows authorised data transfer to the HAPI FHIR server through the OpenHIM.</p><p>An example of what the core package includes, as well as how a sample package (in this case the Health-Workforce package) may use the services the core package provides, is shown below.</p><div class="text--center"><img alt="Package architecture" src="/instant/img/instant-ohie-generic-arch.png"></div><p>To use the HAPI FHIR server from an external point of care application, you can access it through the OpenHIM at a URL like the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">openhim_core_transaction_api_url</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">/fhir/Patient</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>The <strong>openhim_core_transaction_api_url</strong> is displayed in the output when starting up Instant OpenHIE</p></blockquote><p>Accessing the services created by this package:</p><ul><li><strong>OpenHIM</strong><ul><li>Console: Displayed in the output during startup</li><li>Username: <strong><a href="mailto:root@openhim.org" target="_blank" rel="noopener noreferrer">root@openhim.org</a></strong></li><li>Password: <strong>instant101</strong></li></ul></li><li><strong>HAPI FHIR</strong><ul><li>This service should not be publicly accessible and <strong>only accessed via the Interoperability Layer</strong></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deployment-strategy"></a>Deployment strategy<a class="hash-link" href="#deployment-strategy" title="Direct link to heading">#</a></h2><p>The OpenHIM was already dockerised so we were able to re-use those images for our work in the core package.
HAPI FHIR didn&#x27;t have official dockerfiles available, however, several community contributed options existed. We chose to use what seemed like the most robust option.</p><p>We supplied Docker Compose files for the setup and configuration of these applications. We chose to split the <code>docker-compose.*.yml</code> files into three concerns:</p><ol><li><strong>Main</strong> <code>docker-compose.yml</code> file - sets up the base applications</li><li><strong>Config</strong> <code>docker-compose.config.yml</code> file - configures the OpenHIM with a channel route to HAPI FHIR</li><li><strong>Dev</strong> <code>docker-compose.dev.yml</code> file - exposes all open port to the host for easy debugging. This should not be used a production environment</li></ol><p>For Kubernetes, we created deployment and service resource files for each component of each application.
The setup is orchestrated by a <code>kustomization.yml</code> file for easy deployment.
To import configuration into the OpenHIM, we use job resources that only execute when the OpenHIM core is up.
This is done with an <code>init container</code> which waits for the OpenHIM core port to become available.</p><p>For importing config, we use a custom image which is just a node.js container that can run node.js scripts that we define.
It also has a <code>wait-on</code> module installed to allow it to wait on certain ports being available before executing.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="core-package-dev-guide"></a>Core Package Dev guide<a class="hash-link" href="#core-package-dev-guide" title="Direct link to heading">#</a></h2><p>For testing purposes, this package can be run independently. Below are some notes of how to do this.
The recommended way to run Instant OpenHIE is described <a href="/instant/docs/introduction/getting-started">here</a>.</p><p>Select a deployment target below and follow the getting started steps in setting up this package.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Docker Compose</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Kubernetes</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>Before proceeding, ensure that you are in the directory (<code>core/docker/</code>) containing the <code>docker-compose</code> script.</p><p>From the working directory, execute our <code>docker-compose</code> script.
This will create all the services and print out their logs in the terminal.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose up</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="useful-compose-flags"></a>Useful compose flags<a class="hash-link" href="#useful-compose-flags" title="Direct link to heading">#</a></h4><p>Some additional flags can be passed to the <code>docker-compose</code> command making it easier to work with.</p><ul><li><code>-d</code>: Run the services in a detached mode. This means that when you close or exit your terminal, the services will still be running in the background.</li><li><code>-f</code>: Specify the location of the <code>docker-compose</code> file to be executed. Omitting this flag will look for the default <code>docker-compose.yml</code> file.</li><li><code>--force-recreate</code>: This will force the container/image to be re-created if a newer version is found. This is useful when a new image has been released but not yet pulled onto the host machine.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose up -d --force-recreate</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="environment-configuration"></a>Environment configuration<a class="hash-link" href="#environment-configuration" title="Direct link to heading">#</a></h4><p>The default script might not suit the type of environment you want to run.
Therefore there are additional <code>docker-compose</code> files available for fine-tuning environment configuration.</p><ul><li><p><strong>docker-compose.yml</strong>: Main <code>docker-compose</code> script to create the services</p></li><li><p><strong>docker-compose.dev.yml</strong>: Development <code>docker-compose</code> script to override some of the default configurations.</p><blockquote><p><strong>Development environment only</strong> as this exposes service ports.</p></blockquote></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="development-configuration"></a>Development configuration<a class="hash-link" href="#development-configuration" title="Direct link to heading">#</a></h5><p>Can specify three <code>docker-compose</code> files.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose -f docker-compose.yml -f docker-compose.dev.yml -f docker-compose.config.yml up -d</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="production-like-configuration"></a>Production-like configuration<a class="hash-link" href="#production-like-configuration" title="Direct link to heading">#</a></h5><p>Should use only two <code>docker-compose</code> files.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose -f docker-compose.yml -f docker-compose.config.yml up -d</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><blockquote><p>If you are working with multiple cluster hosting clients you may need to switch cluster context for your deployment. See the below commands:</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl config get-contexts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl config use-context &lt;context-name&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="minikube-local"></a>Minikube (local)<a class="hash-link" href="#minikube-local" title="Direct link to heading">#</a></h4><p>For the Kubernetes deployment to work as expected, we need to ensure we have <code>minikube</code> installed on our local machine running the deployment.
Follow these steps to <a href="https://kubernetes.io/docs/tasks/tools/install-minikube/" target="_blank" rel="noopener noreferrer">install minikube</a></p><p>Once installed, we can start the minikube service by executing the below command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">minikube start --cpus 4 --memory 8192</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This also updates the VM settings to make use of 4 CPU&#x27;s and 8GB of RAM, instead of the default 2 CPU&#x27;s and 4GB of RAM</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-started"></a>Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">#</a></h4><p>Useful Links:</p><ul><li><a href="https://www.digitalocean.com/community/cheatsheets/getting-started-with-kubernetes-a-kubectl-cheat-sheet" target="_blank" rel="noopener noreferrer">Kubectl Cheat Sheet</a></li></ul><p>Before we proceed with creating our <code>Core Package</code> services, we need to ensure we are in the correct directory containing our bash setup scripts.</p><p>Once you are in the correct working directory (<code>core/kubernetes</code>) we can proceed to create our core Instant OpenHIE deployment with the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./main/k8s.sh up</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The OpenHIM console url will be displayed in the terminal output when the script completes. The Url may take a few minutes to become active as the pod may not be fully initialized yet.</p><p>This bash script will apply the kubernetes <code>kustomization.yaml</code> file which controls the <code>Core Package</code> components (i.e. OpenHIM and HAPI-FHIR).</p><blockquote><p>On first run, the setup may take up to 10 minutes as the Docker images for each component will need to be pulled. This won&#x27;t happen on future runs.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="view-running-kubernetes-resources"></a>View running Kubernetes resources<a class="hash-link" href="#view-running-kubernetes-resources" title="Direct link to heading">#</a></h4><p>Execute the below commands to see the running Kubernetes resources and the state that they are in.</p><p>To display all resource: (Some new resources are not listed here)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get all --all-namespaces</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To tear down this deployment, use the opposing command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./main/k8s.sh down</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To completely remove all project components, use the following option:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./main/k8s.sh destroy</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><hr><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="initial-openhim-config"></a>Initial OpenHIM Config<a class="hash-link" href="#initial-openhim-config" title="Direct link to heading">#</a></h4><p>We have included a useful set of scripts to initialize the OpenHIM and set it up to communicate with the HAPI-FHIR server.
This will change the default user&#x27;s password of the OpenHIM to <code>instant101</code>, and create a channel configured to route traffic to the HAPI-FHIR instance.
From the <code>kubernetes</code> directory, use the following command to implement:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./importer/k8s.sh up</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>These scripts can be duplicated and modified to implement custom imports</p></blockquote><p>To clean up the remaining job and pods from a successful setup, run the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./importer/k8s.sh clean</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Once the config is done HAPI FHIR will be accessible on: <a href="https://OPENHIM_CORE_HOSTNAME/fhir/" target="_blank" rel="noopener noreferrer">https://OPENHIM_CORE_HOSTNAME/fhir/</a></p><p>You can test that the OpenHIM is routing requests to HAPI FHIR by running:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./test.sh </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">OPENHIM_CORE_HOSTNAME</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><hr><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="development-mode-for-exposed-services"></a>Development mode for exposed services<a class="hash-link" href="#development-mode-for-exposed-services" title="Direct link to heading">#</a></h4><p>To run in development mode, run the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">./dev/k8s.dev.sh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>In this mode the OpenHIM mongo database, HAPI FHIR server, and the MySQL database can be accessed directly from their urls.</p></blockquote><hr></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/openhie/instant/tree/master/docs/docs/packages/core.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/instant/docs/how-to/setup-instant-on-windows-wsl"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« How to setup Instant OpenHIE on Windows with WSL</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/instant/docs/packages/facility"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Facility-Registry Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#package-functionality" class="table-of-contents__link">Package functionality</a></li><li><a href="#deployment-strategy" class="table-of-contents__link">Deployment strategy</a></li><li><a href="#core-package-dev-guide" class="table-of-contents__link">Core Package Dev guide</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://ohie.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenHIE</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div></div></div></footer></div>
<script src="/instant/assets/js/runtime~main.2e65fd97.js"></script>
<script src="/instant/assets/js/main.a4fada6b.js"></script>
</body>
</html>