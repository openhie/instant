<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/instant/blog/rss.xml" title="Instant OpenHIE Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/instant/blog/atom.xml" title="Instant OpenHIE Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Instant OpenHIE" href="/instant/opensearch.xml"><title data-react-helmet="true">Architecture | Instant OpenHIE</title><meta data-react-helmet="true" property="og:url" content="https://openhie.github.io/instant/docs/more-info/architecture"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Architecture | Instant OpenHIE"><meta data-react-helmet="true" name="description" content="A description of the instant OpenHIE technical architecture"><meta data-react-helmet="true" property="og:description" content="A description of the instant OpenHIE technical architecture"><meta data-react-helmet="true" name="keywords" content="Instant OpenHIE,Architecture"><link data-react-helmet="true" rel="shortcut icon" href="/instant/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openhie.github.io/instant/docs/more-info/architecture"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/more-info/architecture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openhie.github.io/instant/docs/more-info/architecture" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/instant/assets/css/styles.658b36c8.css">
<link rel="preload" href="/instant/assets/js/runtime~main.498d3302.js" as="script">
<link rel="preload" href="/instant/assets/js/main.751898b9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a><a class="navbar__item navbar__link" href="/instant/docs/introduction/vision">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/instant/"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Instant OpenHIE</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/instant/docs/introduction/vision">Docs</a></li><li class="menu__list-item"><a href="https://github.com/openhie/instant" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/vision">Vision</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/community">Community</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/package-arch">Packages</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How-to</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/creating-packages">Create packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/setup-kubernetes-in-cloud">Setup managed Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/configure-openhim-mapping-mediator">Configure OpenHIM Mapping Mediator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/configure-dhis2">Configure HMIS (DHIS2)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Existing Packages</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/core">Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/facility">Facility-Registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/hmis">Health Management Information System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/health-worker">Health-Worker-Registry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/health-workforce">Health-Workforce</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/packages/client">Client-Registry</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">More Information</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/instant/docs/more-info/architecture">Architecture</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Architecture</h1></header><div class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The Instant OpenHIE architecture, codebase, and documentation are under active development and are subject to change. While we encourage adoption and extension of the Instant OpenHIE framework, we do not consider this ready for production use at this stage.</p></div></div><p>The fundamental concept of Instant OpenHIE is that it can be extended to support additional use cases and workflows. This is achieved through packages. Packages conform to a specific set of rules and contain scripts and resources that allow particular applications to be spun up and configured on the platforms supported by Instant OpenHIE. The currently supported platforms are <strong>local deployments via Docker and Docker Compose</strong> and deployment to a <strong>Kubernetes cluster</strong>.</p><p>Packages alone, however, do not solve the whole problem. A consistent way of managing and executing these packages is necessary. Much of the work that goes into Instant OpenHIE is developing the software that enables the packages to be managed and executed.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="package-architecture"></a>Package architecture<a class="hash-link" href="#package-architecture" title="Direct link to heading">#</a></h1><p>Packages can be one of two different types. An <strong>infrastructural package</strong> or a <strong>use case package</strong>. Infrastructural packages setup and configure particular applications or sets of applications that are commonly grouped together. By themselves these packages just get the applications started and they aren&#x27;t configured for a particular use case. On the other hand, use case packages depend on infrastructural packages and configure the applications set up by them and setup additional mediators that allow these applications to work together. They do this to enable a particular use case to be enacted.</p><p>You can think of use case packages as adding features to the end-user whereas infrastructural packages provide the dependencies to the use case packages. This separation allows an infrastructural package that, say implements a FHIR server to be replaced with different packages that implement a different FHIR server. As long as these packages can be configured in a standards-based way, a use case packages could work with either of these infrastructural packages. This gives users options for the applications that they wish to use.</p><div class="text--center"><img alt="Package architecture" src="/instant/img/instant-openhie-package-arch.png"></div><p>Each package will contain the following sorts of technical artifacts that allow it to be spun up and down within the supported platforms:</p><ul><li>Docker Compose scripts for setting up the applications required for this packageâ€™s use cases and workflows</li><li>Kubernetes scripts for setting up the applications required for this packageâ€™s use cases and workflows</li><li>Configuration scripts to setup required configuration metadata</li><li>Extensions to the test harness to test the added use cases with test data</li></ul><p>The exact artefacts that go into a package are described in the section on <a href="/instant/docs/how-to/creating-packages">creating packages</a>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="execution-architecture"></a>Execution architecture<a class="hash-link" href="#execution-architecture" title="Direct link to heading">#</a></h1><p>Much of the tooling that Instant OpenHIE provides is to allow packages to be executed once they have been defined. The core principles of the execution architecture are that:</p><ul><li>Packages may be executed in a cross platform way (on Window, OSX or Linux)</li><li>Complexity should be hidden from the user to make spinning up packages easy</li><li>The software that executes the packages should be self contained so that it is easy to download and get running</li></ul><p>The core concept of the execution architecture is that all the tooling to execute packages contained within a single docker image - called the execution image. This enables it to run cross-platform as long as the required dependencies are installed (Docker Desktop for Windows/OSX or Docker engine and Docker compose for Linux). To enable the execution image to spin up packages using docker it is passed the docker socket file from the host so that any containers it created are in fact created on the host. It may also be passed other configuration form the host for other platforms such as Kubernetes to allow it to deploy packages to those platforms as well using the user&#x27;s current cluster configuration. The execution image gives us a consistent environment to develop for and allow us to run the scripts that execute the packages without caring about the underlying host OS, we just need to interface with the deployment platform.</p><p>An overview of the architecture is displayed below. Following that we describe how these components all works together in the sections that follow.</p><div class="text--center"><img alt="Package architecture" src="/instant/img/instant-openhie-arch.png"></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="go-executable-cli-app"></a>Go executable CLI app<a class="hash-link" href="#go-executable-cli-app" title="Direct link to heading">#</a></h2><p>The CLI app will allow the setup and configuration of Instant OpenHIE to be easily managed by the user. It is the only executable that the user would need to download to interact with instant OpenHIE. It is written in Go so that it may compile to a platform-independent executable with 0 dependencies. It will know how to fetch the execution image from docker hub and be able to execute it at the command of the user.</p><p>The app will allow the user to execute it as an interactive CLI tool, however, it will also have the ability to launch a Web UI and API server that work together to provide the user with a Web interface for managing and executing Instant OpenHIE. Choices made in the Web UI will be sent to the API server and from there the server will issue commands by running the execution image with a particular set of parameters as shown in the diagram.</p><p>The CLI app will also be responsible for ensuring the execution image is executed with the correct configuration to ensure it works cross-platform and with the necessary user setting. For example, it will mount the docker socket file into the container so that docker containers are created on the host and it will mount various user config files for Kubernetes, docker hub and/or AWS credentials. This enables the execution image to execute as if it were configured like the user&#x27;s host system.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-entry-point-script"></a>The entry point script<a class="hash-link" href="#the-entry-point-script" title="Direct link to heading">#</a></h2><p>The execution image, when executed itself, runs an execution script that is written in Typescript. The purpose of this script is to accept various parameters via the command line, discover the available packages and execute the requested action for a list of the available packages. The list of commandline options that it supports is shown as an example in the architecture diagram. This script is the heart of Instant OpenHIE as it is what actually executes and controls the packages. When the execution image is run this is the script that gets executed to perform all actions.</p><p>The execution image bundles all the dependencies that the execution script requires so that when the CLI app downloads the execution image from docker hub it is ready to go. The user will be required to have docker installed to run this image. The bundled dependencies in this image include: the docker and docker-compose clients, kubectl and the cucumber executable for testing purposes.</p><p>It is also the responsibility of this script to determine dependencies between packages and ensure that the packages are spun up in dependency order, starting with the <a href="/instant/docs/packages/core">Core package</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="bundled-packages"></a>Bundled packages<a class="hash-link" href="#bundled-packages" title="Direct link to heading">#</a></h2><p>The execution image also bundles a number of official Instant OpenHIE packages. The list of packages will increase over time as more applications and use cases are added to the default Instant OpenHIE installation. View the current packages that have been created along with a description of what they do in the sidebar.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3rd-party-packages"></a>3rd party packages<a class="hash-link" href="#3rd-party-packages" title="Direct link to heading">#</a></h2><p>Instant OpenHIE can be extended to support more packages than those that are bundled by default in the execution image. The 3rd party package&#x27;s folder need only be mounted into the container in the <code>/instant/</code> folder. As long as the package folder contains an <code>instant.json</code> file it will be detected and made available. The CLI app may choose in the future to enable the user to download external packages (e.g. from a github repo) and make them available to the execution image to make it easy for the user to extend Instant OpenHIE functionality with custom packages.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-harness"></a>Test harness<a class="hash-link" href="#test-harness" title="Direct link to heading">#</a></h2><p>A test harness is also built into the execution image that can execute a suite of tests against the stood up infrastructure and ensure that they are functioning correctly. The test harness utilizes the Gerkin language to describe tests and the Cucumber tool to execute these. Packages are required to include a Gerkin feature file and the source code that is able to execute the features in a <code>features</code> folder. The entry point script can then execute these test scripts on demand for each package. This provides the user with a mechanism to test an instantiation of the architecture and provides a way to explore what each use case package can do.</p><p>If you are looking for more information see the <a href="/instant/docs/introduction/getting-started">getting started section</a> or learn about <a href="/instant/docs/how-to/creating-packages">how package are structured</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/openhie/instant/tree/master/docs/docs/more-info/architecture.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/instant/docs/packages/client"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Client-Registry</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#go-executable-cli-app" class="table-of-contents__link">Go executable CLI app</a></li><li><a href="#the-entry-point-script" class="table-of-contents__link">The entry point script</a></li><li><a href="#bundled-packages" class="table-of-contents__link">Bundled packages</a></li><li><a href="#3rd-party-packages" class="table-of-contents__link">3rd party packages</a></li><li><a href="#test-harness" class="table-of-contents__link">Test harness</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://ohie.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenHIE</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div></div></div></footer></div>
<script src="/instant/assets/js/runtime~main.498d3302.js"></script>
<script src="/instant/assets/js/main.751898b9.js"></script>
</body>
</html>